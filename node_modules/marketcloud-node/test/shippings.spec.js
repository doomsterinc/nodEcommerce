var marketcloud = require('../index.js'),
	mocha = require('mocha'),
	chai = require('chai');

var expect = chai.expect;

var client = null;
var shipping_id = null;
describe('Shippings',function(){

	before(function(){

		client = new marketcloud.Client({
			public_key : process.env.MARKETCLOUD_PUBLIC_KEY,
    		secret_key : process.env.MARKETCLOUD_SECRET_KEY
		})
	})


	it('Should retrieve a list of shippings',function(){
		return client.shippings.list({})
			.then(function(response){
				expect(response.length).to.not.equal(0);
				expect(response.length).to.be.at.most(20);
				shipping_id = response[0].id;
				console.log("response[0]",response[0])

			})
	});


	it('Should retrieve a specific shipping',function(){
		return client.shippings.getById(shipping_id)
			.then(function(response){
				
				expect(response.id).to.equal(shipping_id);
				
			})
	})

	it('Should create a shipping',function(){

		var shipping = {
		    "availability" : "ALL",
		    "base_cost" : 10,
		    "per_item_cost" : 0.5,
		    "zones" : [ 
		        {
		            "name" : "Italy",
		            "code" : "IT"
		        }
		    ],
		    "rules" : [ 
		        {
		            "name" : "max_value",
		            "value" : 30
		        }
		    ],
		    "name" : "Regular shipping",
		}

		return client.shippings.create(shipping)
			.then(function(response){
				var shipping_id = response.id
				
			})

	})

	it('Should update a shipping',function(){
		var update = {
			name : 'Updated shipping name'
		}
		return client.shippings.update(shipping_id,update)
								.then(function(response){
									
								})
	})


	it('Should delete a shipping',function(){
		return client.shippings.delete(shipping_id)
				.then(function(response){
					
				})
	})

	
})